(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{381:function(t,s,a){"use strict";a.r(s);var n=a(25),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"自定义脚手架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义脚手架"}},[t._v("#")]),t._v(" 自定义脚手架")]),t._v(" "),s("p",[t._v("init 初始化Vue定制的模板工程\n补充更多功能\nupload image：上传图片到 cdn,base64（多少转base64）\nCICD脚本")]),t._v(" "),s("p",[t._v("脚手架就是快速帮你搭建项目架构的工具")]),t._v(" "),s("h2",{attrs:{id:"bin的使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bin的使用"}},[t._v("#")]),t._v(" bin的使用")]),t._v(" "),s("h3",{attrs:{id:"创建package-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建package-json"}},[t._v("#")]),t._v(" 创建package.json")]),t._v(" "),s("p",[s("code",[t._v("npm init -y")])]),t._v(" "),s("h3",{attrs:{id:"配置package-json的bin字段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置package-json的bin字段"}},[t._v("#")]),t._v(" 配置package.json的bin字段")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// script的tsc等命令，也是到依赖的.bin去操作的")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bin"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"kdvip"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./bin/index.js"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h3",{attrs:{id:"在bin文件夹下-书写index-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在bin文件夹下-书写index-js"}},[t._v("#")]),t._v(" 在bin文件夹下，书写index.js")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token hashbang comment"}},[t._v("#!/usr/bin/env node")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"上传包到本地"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上传包到本地"}},[t._v("#")]),t._v(" 上传包到本地")]),t._v(" "),s("p",[s("code",[t._v("npm link")])]),t._v(" "),s("h3",{attrs:{id:"执行bin脚本命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行bin脚本命令"}},[t._v("#")]),t._v(" 执行bin脚本命令")]),t._v(" "),s("p",[s("code",[t._v("kdvip")])]),t._v(" "),s("h2",{attrs:{id:"monorepo工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#monorepo工具"}},[t._v("#")]),t._v(" monorepo工具")]),t._v(" "),s("h3",{attrs:{id:"pnpm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pnpm"}},[t._v("#")]),t._v(" pnpm")]),t._v(" "),s("h4",{attrs:{id:"安装依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[t._v("#")]),t._v(" 安装依赖")]),t._v(" "),s("p",[t._v("在 bash 终端运行: "),s("code",[t._v("pnpm i")])]),t._v(" "),s("ul",[s("li",[t._v("⭐️ 节省磁盘空间场景")])]),t._v(" "),s("p",[t._v("在一个项目中有大量的依赖包，尤其是在多个项目或工作空间存在相同依赖时，pnpm能够共享这些相同的依赖包，\n从而大大节省磁盘空间。")]),t._v(" "),s("ul",[s("li",[t._v("⭐️ 高效安装场景")])]),t._v(" "),s("p",[t._v("在同时开发多个项目且项目存在重复依赖的工作场景下，pnpm安装依赖的速度更快。它采用了一种独特的链接方式来管理依赖，相比传统的npm或yarn,在安装大量依赖包时可以减少文件的复制操作，加快安装过程。")]),t._v(" "),s("h3",{attrs:{id:"lerna"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna"}},[t._v("#")]),t._v(" lerna")]),t._v(" "),s("ul",[s("li",[t._v("⭐️ 版本管理场景")])]),t._v(" "),s("p",[t._v("如果这些软件包之间相互依赖，并且需要统一管理版本发布，Lerna可以轻松处理。它能确保所有相互依赖的包\n在版本升级时保持同步，避免因为版本不一致导致的兼容问题。换言之，复杂的大型项目中有多个内部包需要\n协同开发、发布，lerna是一个不错的选择。")]),t._v(" "),s("h4",{attrs:{id:"常见命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见命令"}},[t._v("#")]),t._v(" 常见命令")]),t._v(" "),s("ul",[s("li",[t._v("npm install lerna")]),t._v(" "),s("li",[t._v("⭐️ npx lerna init 初始化lerna")]),t._v(" "),s("li",[t._v("⭐️ lerna run test 运行子包的script/脚本命令")]),t._v(" "),s("li",[t._v("⭐️ lerna clean 删除子包的依赖，注：不会删除项目所在根的依赖")]),t._v(" "),s("li",[t._v("lerna create shared 创建子包")]),t._v(" "),s("li",[t._v("⭐️ lerna publish 发布包")])]),t._v(" "),s("p",[t._v("lerna publish 运行的是lerna.json的command的配制。registry也可以选择私有网址")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"npmClient"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pnpm"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"useWorkspaces"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"command"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"publish"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"npmClient"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"npm"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"chore(release): publish %s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://registry.npmjs.org"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"packages"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"packages/*"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"入门"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#入门"}},[t._v("#")]),t._v(" 入门")]),t._v(" "),s("ul",[s("li",[t._v("安装指定版本的lerna")]),t._v(" "),s("li",[t._v("编写lerna.json")]),t._v(" "),s("li",[t._v("书写LICENSE，发布时需要协议证书（github新建仓库的时候，可以选择证书）")])]),t._v(" "),s("h4",{attrs:{id:"lerna和pnpm一起使用-详见官网"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna和pnpm一起使用-详见官网"}},[t._v("#")]),t._v(" lerna和pnpm一起使用，详见官网")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://lerna.nodejs.cn/docs/recipes/using-pnpm-with-lerna",target:"_blank",rel:"noopener noreferrer"}},[t._v("lerna秘诀"),s("OutboundLink")],1)]),t._v(" "),s("h4",{attrs:{id:"lerna发包精要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna发包精要"}},[t._v("#")]),t._v(" ⭐️ lerna发包精要")]),t._v(" "),s("div",{staticClass:"language-md extra-class"},[s("pre",{pre:!0,attrs:{class:"language-md"}},[s("code",[t._v("npm config get registry\nnpm config set registry=https://registry.npmjs.org\nnpm login \n用户名：durant123\n密码：SJQ***"),s("span",{pre:!0,attrs:{class:"token bold"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("**")]),s("span",{pre:!0,attrs:{class:"token content"}},[s("span",{pre:!0,attrs:{class:"token italic"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token content"}},[t._v(".(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("*")])])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("**")])]),t._v("***是手机密码)\n\nnpm config set proxy null\nnpm cache clean --force\nnpm config set registry=https://registry.npmjs.org\n提完代码，lerna publish\n")])])]),s("ul",[s("li",[t._v("代理问题，多次使用被视为翻墙。npm config set proxy null && npm cache clean --force")]),t._v(" "),s("li",[t._v("lerna发包，一定要有改动并提交的代码")]),t._v(" "),s("li",[t._v("如果要one-time-password, 手机设备的软件AUthenticator，有一次性验证码")]),t._v(" "),s("li",[t._v("ECONNRESET可能网络问题，稍后重试。解决代理问题，继续重试lerna发布。eg: lerna ERR! lerna The \"code\" argument must be of type number. Received type string ('ECONNRESET')")]),t._v(" "),s("li",[t._v("书写LICENSE，发布时需要协议证书（github新建仓库的时候，可以选择证书）")])]),t._v(" "),s("h2",{attrs:{id:"本地开发子包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本地开发子包"}},[t._v("#")]),t._v(" 本地开发子包")]),t._v(" "),s("ul",[s("li",[t._v("pnpm init 或者npm init -y")])]),t._v(" "),s("h2",{attrs:{id:"git规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git规范"}},[t._v("#")]),t._v(" Git规范")]),t._v(" "),s("h3",{attrs:{id:"常用的钩子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用的钩子"}},[t._v("#")]),t._v(" 常用的钩子")]),t._v(" "),s("ul",[s("li",[t._v("pre-commit：在"),s("code",[t._v("git commit")]),t._v(" 之前触发，常用于对提交的代码文件进行规范校验")]),t._v(" "),s("li",[t._v("commit-msg：在"),s("code",[t._v("git commit")]),t._v("后触发，用于提交消息的格式校验")])]),t._v(" "),s("h3",{attrs:{id:"husky-更好使用git钩子管理项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#husky-更好使用git钩子管理项目"}},[t._v("#")]),t._v(" husky：更好使用git钩子管理项目")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("npx husky install")]),t._v("或"),s("code",[t._v("husky install")])])]),t._v(" "),s("h3",{attrs:{id:"changelog-维护git更新日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#changelog-维护git更新日志"}},[t._v("#")]),t._v(" changelog：维护Git更新日志")]),t._v(" "),s("p",[t._v("参考vue源码等")]),t._v(" "),s("p",[t._v("脚本命令changelog："),s("code",[t._v("conventional-changelog -p angular -i CHANGELOG.md -s")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dependencies"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conventional-changelog-conventionalcommits"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^4.5.0"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"lint工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lint工具"}},[t._v("#")]),t._v(" lint工具")]),t._v(" "),s("h3",{attrs:{id:"commitlint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commitlint"}},[t._v("#")]),t._v(" commitlint")]),t._v(" "),s("h4",{attrs:{id:"开发子包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开发子包"}},[t._v("#")]),t._v(" 开发子包")]),t._v(" "),s("ul",[s("li",[t._v("pnpm init，生成package.json")]),t._v(" "),s("li",[t._v("该包名有特殊命名规范：commitlint-config-包名。")])]),t._v(" "),s("p",[s("code",[t._v("Install @commitlint/cli and a @commitlint/config-* / commitlint-config-* of your choice as devDependency and configure commitlint to use it.")])]),t._v(" "),s("ul",[s("li",[t._v("安装依赖")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dependencies"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conventional-changelog-conventionalcommits"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^4.5.0"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("入口文件")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//官方文档的cli说明中的parserPreset，用于解析提交消息的解析器预设")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("parserPreset")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'conventional-changelog-conventionalcommits'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rules")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("规则"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"commit-msg的类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commit-msg的类型"}},[t._v("#")]),t._v(" commit-msg的类型")]),t._v(" "),s("ul",[s("li",[t._v("ci: ci 配置文件和脚本的变动;")]),t._v(" "),s("li",[t._v("chore: 构建系统或辅助工具的变动;")]),t._v(" "),s("li",[t._v("fix: 代码 BUG 修复;")]),t._v(" "),s("li",[t._v("feat: 新功能;")]),t._v(" "),s("li",[t._v("perf: 性能优化和提升;")]),t._v(" "),s("li",[t._v("refactor: 仅仅是代码变动，既不是修复 BUG 也不是引入新功能;")]),t._v(" "),s("li",[t._v("style: 代码格式调整，可能是空格、分号、缩进等等;")]),t._v(" "),s("li",[t._v("docs: 文档变动;")]),t._v(" "),s("li",[t._v("test: 补充缺失的测试用例或者修正现有的测试用例;")]),t._v(" "),s("li",[t._v("revert: 回滚操作;")])]),t._v(" "),s("h4",{attrs:{id:"扩展"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#扩展"}},[t._v("#")]),t._v(" 扩展")]),t._v(" "),s("ul",[s("li",[t._v("cz-git结合cz-commitlint")])]),t._v(" "),s("h3",{attrs:{id:"eslint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#eslint"}},[t._v("#")]),t._v(" eslint")]),t._v(" "),s("p",[t._v("在运行代码前就发现语法错误和潜在的bug,非常适合用于制定团队代码规范")]),t._v(" "),s("h4",{attrs:{id:"子包的脚本命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#子包的脚本命令"}},[t._v("#")]),t._v(" 子包的脚本命令")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"lint"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint ./"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mocha ./__tests__/*.test.js --timeout 5000"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"print-config"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --print-config ./index.js > ./print-config.json"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"prettier"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prettier"}},[t._v("#")]),t._v(" prettier")]),t._v(" "),s("p",[t._v("代码格式化工具。")]),t._v(" "),s("h3",{attrs:{id:"markdownlint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#markdownlint"}},[t._v("#")]),t._v(" markdownlint")]),t._v(" "),s("h4",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/DavidAnson/markdownlint",target:"_blank",rel:"noopener noreferrer"}},[t._v("markdownlint"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/igorshubovych/markdownlint-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("markdownlint-cli"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("code",[t._v("MarkdownLint CLI 是一个用于检查 Markdown 文档语法错误的命令行工具")])]),t._v(" "),s("h4",{attrs:{id:"pre-commit可校验markdown文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pre-commit可校验markdown文件"}},[t._v("#")]),t._v(" pre-commit可校验markdown文件")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# !/usr/bin/env sh")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dirname")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v('/_/husky.sh"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" run mdlint\n")])])]),s("p",[t._v("脚本命令"),s("code",[t._v('"mdlint": "markdownlint **/*.md --ignore node_modules"')])]),t._v(" "),s("h3",{attrs:{id:"stylelint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stylelint"}},[t._v("#")]),t._v(" stylelint")]),t._v(" "),s("h4",{attrs:{id:"平时项目开发-不用脚手架的能力-如何使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#平时项目开发-不用脚手架的能力-如何使用"}},[t._v("#")]),t._v(" 平时项目开发，不用脚手架的能力，如何使用")]),t._v(" "),s("ul",[s("li",[t._v("配制规则")]),t._v(" "),s("li",[t._v("安装所需依赖stylelint和配制规则用到的依赖")]),t._v(" "),s("li",[t._v("配制脚本命令"),s("code",[t._v('"lint": "stylelint \\"**/*.scss\\"""')])])]),t._v(" "),s("h4",{attrs:{id:"配制规则参考官网"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配制规则参考官网"}},[t._v("#")]),t._v(" 配制规则参考官网")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://stylelint.nodejs.cn/user-guide/rules",target:"_blank",rel:"noopener noreferrer"}},[t._v("用户指南的规则"),s("OutboundLink")],1)]),t._v(" "),s("h4",{attrs:{id:"开发子包需注意"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开发子包需注意"}},[t._v("#")]),t._v(" 开发子包需注意")]),t._v(" "),s("ul",[s("li",[t._v("scss,less写测试用例，")])]),t._v(" "),s("h2",{attrs:{id:"cli"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cli"}},[t._v("#")]),t._v(" cli")]),t._v(" "),s("h3",{attrs:{id:"init"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#init"}},[t._v("#")]),t._v(" init")]),t._v(" "),s("ol",[s("li",[t._v("检查cli包版本更新")]),t._v(" "),s("li",[t._v("是否使用对应的lint工具（默认使用eslint,只要选择eslint类型）")]),t._v(" "),s("li",[t._v("检测到项目中存在可能与 cli包 冲突的依赖和配置")]),t._v(" "),s("li",[t._v("注入script（包名-scan: 包名 scan, 包名-fix: 包名 fix），添加git hooks。（pre-commit:包名 commit-file-scan, commit-msg:包名 commit-msg-scan）。触发的都是bin目录下的脚本命令。")]),t._v(" "),s("li",[t._v("更新package.json文件，生成所有的配制文件")])]),t._v(" "),s("p",[t._v("关键代码：")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[t._v("pkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("husky"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pre-commit'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PKG_NAME")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" commit-file-scan")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("husky"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'commit-msg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PKG_NAME")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" commit-msg-scan")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nprogram\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'commit-file-scan'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'代码提交检查: git commit 时对提交代码进行规范问题扫描'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("option")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-s, --strict'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'严格模式，对 warn 和 error 问题都卡口，默认仅对 error 问题卡口'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nprogram\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'commit-msg-scan'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'commit message 检查: git commit 时对 commit message 进行检查'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"scan"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scan"}},[t._v("#")]),t._v(" scan")]),t._v(" "),s("ol",[s("li",[t._v("使用lint工具，却没有安装依赖。")]),t._v(" "),s("li",[t._v("比较package.json和包名.config.js的区别，通过脚本命令的可选参数，调用lint工具的API能力，\n获取对应的scan信息。")]),t._v(" "),s("li",[t._v("在控制台打印扫描报告")])]),t._v(" "),s("h3",{attrs:{id:"fix"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fix"}},[t._v("#")]),t._v(" fix")]),t._v(" "),s("ol",[s("li",[t._v("使用lint工具，却没有安装依赖。")]),t._v(" "),s("li",[t._v("使用prettier格式化代码")]),t._v(" "),s("li",[t._v("比较package.json和包名.config.js的区别，通过脚本命令的可选参数，调用lint工具的API能力，\n获取对应的scan信息。")]),t._v(" "),s("li",[t._v("在控制台打印扫描报告")])]),t._v(" "),s("h3",{attrs:{id:"commit-file-scan"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commit-file-scan"}},[t._v("#")]),t._v(" commit-file-scan")]),t._v(" "),s("ol",[s("li",[t._v("使用lint工具，却没有安装依赖。")]),t._v(" "),s("li",[t._v("获取未 add 的修改文件数量，比较工作区与暂存区的代码，提示是否有暂存的代码想要提交。")]),t._v(" "),s("li",[t._v("获取此次 commit 修改的文件列表")]),t._v(" "),s("li",[t._v("比较package.json和包名.config.js的区别，通过脚本命令的可选参数，调用lint工具的API能力，\n获取对应的scan信息。")]),t._v(" "),s("li",[t._v("在控制台打印扫描报告")])]),t._v(" "),s("h3",{attrs:{id:"commit-msg-scan"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#commit-msg-scan"}},[t._v("#")]),t._v(" commit-msg-scan")]),t._v(" "),s("ol",[s("li",[t._v("使用commitlint 对 git commit 的 commit message 进行检查")])]),t._v(" "),s("h3",{attrs:{id:"update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update"}},[t._v("#")]),t._v(" update")]),t._v(" "),s("ol",[s("li",[t._v("检查当前版本与最新版本，看是否安装最新的脚手架的包。")])]),t._v(" "),s("h3",{attrs:{id:"package-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#package-json"}},[t._v("#")]),t._v(" package.json")]),t._v(" "),s("div",{staticClass:"language-md extra-class"},[s("pre",{pre:!0,attrs:{class:"language-md"}},[s("code",[t._v('  // ???\n  "dev": "npm run copyfiles && tsc -w",\n  // tsc编译src下的源代码\n  "build": "rm -rf lib && npm run copyfiles && tsc",\n  // 拷贝config下的ejs文件到lib目录下。\n  "copyfiles": "copyfiles -a -u 1 \\"src/config/**\\" lib",\n  // 编译后，检测代码\n  "test": "npm run build && jest",\n  // 测试代码覆盖率\n  "coverage": "nyc jest --silent --forceExit",\n  // prepublishOnly: 在npm publish命令前执行\n  "prepublishOnly": "npm run test"\n')])])]),s("h2",{attrs:{id:"测试工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试工具"}},[t._v("#")]),t._v(" 测试工具")]),t._v(" "),s("h3",{attrs:{id:"jest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jest"}},[t._v("#")]),t._v(" jest")]),t._v(" "),s("h4",{attrs:{id:"官方使用指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#官方使用指南"}},[t._v("#")]),t._v(" 官方使用指南")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ES6 Class Mocks")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Using with puppeteer操作木偶的人")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 写法类似，有什么区别")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("describe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Google'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("beforeAll")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("goto")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://google.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'should be titled \"Google\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resolves"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Google'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"项目案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目案例"}},[t._v("#")]),t._v(" 项目案例")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" assert "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'assert'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" stylelint "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stylelint'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("describe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test/rules-validate.test.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Validate default'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" filePaths "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./fixtures/index.css'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" stylelint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("configFile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../index.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("files")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" filePaths"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fix")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("errored"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" filesResult "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("output "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      filesResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fileResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("========= ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("filePaths"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" ==========")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("warnings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      assert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ok")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filesResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"静态资源站点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#静态资源站点"}},[t._v("#")]),t._v(" 静态资源站点")]),t._v(" "),s("h3",{attrs:{id:"vuepress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vuepress"}},[t._v("#")]),t._v(" VuePress")]),t._v(" "),s("p",[t._v("我们把代码提交到github,actions上可以看到部署信息。")]),t._v(" "),s("div",{staticClass:"language-md extra-class"},[s("pre",{pre:!0,attrs:{class:"language-md"}},[s("code",[t._v('.github\n    workflows\n        docs.yml(git actions方案一, 看官网配制)\ndocs\n    .vuepress\n        config.js\n    README.md\n.gitignore\ndeploy.sh(git actions 方案二，看官网配制)\npackage.json\n    scripts\n        "docs:dev": "vuepress dev docs",\n        "docs:build": "vuepress build docs",\n        "deploy": "bash deploy.sh",\n')])])]),s("h2",{attrs:{id:"lint扩展"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lint扩展"}},[t._v("#")]),t._v(" lint扩展")]),t._v(" "),s("h3",{attrs:{id:"为什么使用lint-stage-ai"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么使用lint-stage-ai"}},[t._v("#")]),t._v(" 为什么使用lint-stage（AI）")]),t._v(" "),s("h4",{attrs:{id:"性能问题-全量校验-vs-增量校验"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#性能问题-全量校验-vs-增量校验"}},[t._v("#")]),t._v(" 性能问题：全量校验 vs 增量校验")]),t._v(" "),s("p",[t._v("lint-staged 的优化：只针对 Git 暂存区（Staged Changes） 中的文件（即本次提交的改动）运行校验，避免不必要的检查。")]),t._v(" "),s("h4",{attrs:{id:"避免-污染-提交历史"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#避免-污染-提交历史"}},[t._v("#")]),t._v(" 避免“污染”提交历史")]),t._v(" "),s("p",[t._v("全量校验的问题：")]),t._v(" "),s("p",[t._v("如果直接运行 prettier --write . 或 eslint --fix .，可能会意外修改大量无关文件（如格式化整个项目）。这些改动会被混入本次提交，导致：")]),t._v(" "),s("ul",[s("li",[t._v("提交历史难以追溯（例如修复 Bug 的提交中混入了格式化的改动）。")]),t._v(" "),s("li",[t._v("代码 Review 时干扰核心变更。")])]),t._v(" "),s("p",[t._v("lint-staged 的精准性：")]),t._v(" "),s("ul",[s("li",[t._v("仅对 本次提交的文件 自动修复（如 --fix 或 --write），确保提交历史的清晰性。")])]),t._v(" "),s("h4",{attrs:{id:"团队协作的强制性规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#团队协作的强制性规范"}},[t._v("#")]),t._v(" 团队协作的强制性规范")]),t._v(" "),s("p",[t._v("全量校验的局限性：")]),t._v(" "),s("ul",[s("li",[t._v("即使配置了 ESLint/Prettier，开发者仍可能跳过校验（例如忘记手动运行命令），导致不规范代码被提交。")])]),t._v(" "),s("p",[t._v("lint-staged + Git Hooks 的强制约束：")]),t._v(" "),s("ul",[s("li",[t._v("通过 husky 在 pre-commit 钩子中触发 lint-staged，每次提交前自动校验，避免遗漏。")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("工具")]),t._v(" "),s("th",[t._v("校验范围")]),t._v(" "),s("th",[t._v("适合场景")]),t._v(" "),s("th",[t._v("缺点")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Eslint/Prettier/Stylelint")]),t._v(" "),s("td",[t._v("全项目")]),t._v(" "),s("td",[t._v("本地开发时手动运行")]),t._v(" "),s("td",[t._v("慢、可能误改无关文件")])]),t._v(" "),s("tr",[s("td",[t._v("lint-stage")]),t._v(" "),s("td",[t._v("暂存区（增量）")]),t._v(" "),s("td",[t._v("提交前的自动校验")]),t._v(" "),s("td",[t._v("精准、搞笑、强制规范")])])])]),t._v(" "),s("h3",{attrs:{id:"lint-staged"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lint-staged"}},[t._v("#")]),t._v(" lint-staged")]),t._v(" "),s("p",[s("code",[t._v("lint-staged")]),t._v(" 是一个用于在 Git 暂存区（staged files）上运行指定工具的工具。它通常用于在提交代码前自动对修改的文件进行代码格式化、静态检查等操作，确保代码质量")]),t._v(" "),s("p",[t._v("主要功能：")]),t._v(" "),s("ul",[s("li",[t._v("仅处理暂存区文件：只对即将提交的文件运行指定的命令，避免处理整个项目。")]),t._v(" "),s("li",[t._v("支持多种工具：可与 ESLint、Prettier、Stylelint 等工具结合使用。")]),t._v(" "),s("li",[t._v("自动化流程：在提交代码前自动执行格式化或检查，确保代码符合规范。")])]),t._v(" "),s("p",[t._v("使用场景：")]),t._v(" "),s("ul",[s("li",[t._v("代码格式化：在提交前使用 Prettier 自动格式化代码。")]),t._v(" "),s("li",[t._v("静态检查：使用 ESLint 检查 JavaScript/TypeScript 代码，确保符合规范。")]),t._v(" "),s("li",[t._v("样式检查：使用 Stylelint 检查 CSS/SCSS 文件。")]),t._v(" "),s("li",[t._v("单元测试：对修改的代码运行相关单元测试。")])]),t._v(" "),s("p",[t._v("总结：lint-staged 是一个高效的工具，帮助开发者在提交代码前自动执行代码检查和格式化，提升代码质量和一致性。")]),t._v(" "),s("p",[t._v("1.安装依赖（详见官网）")]),t._v(" "),s("p",[t._v("2.packjson.json 配置（详见官网，待测）")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"lint-staged"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"prettier --write"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"*.{vue,ts}"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --fix"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"*.{html,vue,css,sass,scss}"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stylelint --fix"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("p",[t._v("3.结合 husky 在提交前自动运行（详见官网，待测）")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"husky"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hooks"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pre-commit"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lint-staged"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),s("p",[t._v("脚手架有什么难以实现的？网银平台（iframe），中台，手机端辅助项目（查询），统一代码规范。\n开辟新项目的时候，要复制一套lint规范，就很费劲。修改lint规则，不好同步到每个项目。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("commit-msg: feat: 需求号-需求名，通过自动化脚本，进行代码提交。")])]),t._v(" "),s("li",[s("p",[t._v("pre-commit: prettier(代码格式化问题)")])]),t._v(" "),s("li",[s("p",[t._v("list-stage: 只针对提交代码，如果整个项目，不好回溯")])]),t._v(" "),s("li",[s("p",[t._v("list-stage, husky, prettier,")])]),t._v(" "),s("li",[s("p",[t._v("暂时用sass, sass-loader过渡， 想使用 UnoCss")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" --save-dev husky lint-staged\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" husky init\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" pkg "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("scripts.prepare")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"husky install"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pnpm lint-staged"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" .husky/pre-commit\n")])])]),s("ul",[s("li",[t._v("配置Prettier规则和忽略文件")]),t._v(" "),s("li",[t._v('配置 添加脚本命令："format": "prettier . --write"')])])])}),[],!1,null,null,null);s.default=r.exports}}]);