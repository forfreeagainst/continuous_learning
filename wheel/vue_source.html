<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue源码 | 时空随笔</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/continuous_learning/img/logo.png">
    <meta name="description" content="用时间换空间，用空间换时间">
    <meta name="keywords" content="修炼笔记静态资源站点">
    
    <link rel="preload" href="/continuous_learning/assets/css/0.styles.6479703d.css" as="style"><link rel="preload" href="/continuous_learning/assets/js/app.a36e4480.js" as="script"><link rel="preload" href="/continuous_learning/assets/js/2.37a86b2d.js" as="script"><link rel="preload" href="/continuous_learning/assets/js/1.f80ffb5b.js" as="script"><link rel="preload" href="/continuous_learning/assets/js/80.e8ad302b.js" as="script"><link rel="prefetch" href="/continuous_learning/assets/js/10.c7f0ff39.js"><link rel="prefetch" href="/continuous_learning/assets/js/11.b9626a80.js"><link rel="prefetch" href="/continuous_learning/assets/js/12.3c9cf08f.js"><link rel="prefetch" href="/continuous_learning/assets/js/13.e652a34a.js"><link rel="prefetch" href="/continuous_learning/assets/js/14.35d86c22.js"><link rel="prefetch" href="/continuous_learning/assets/js/15.2a05c459.js"><link rel="prefetch" href="/continuous_learning/assets/js/16.eac0ba20.js"><link rel="prefetch" href="/continuous_learning/assets/js/17.5e08e882.js"><link rel="prefetch" href="/continuous_learning/assets/js/18.72fa03b1.js"><link rel="prefetch" href="/continuous_learning/assets/js/19.2dc1dc0c.js"><link rel="prefetch" href="/continuous_learning/assets/js/20.4294c7a5.js"><link rel="prefetch" href="/continuous_learning/assets/js/21.819cdda0.js"><link rel="prefetch" href="/continuous_learning/assets/js/22.5c21a410.js"><link rel="prefetch" href="/continuous_learning/assets/js/23.44f46fee.js"><link rel="prefetch" href="/continuous_learning/assets/js/24.8ee95c2d.js"><link rel="prefetch" href="/continuous_learning/assets/js/25.1f29eb41.js"><link rel="prefetch" href="/continuous_learning/assets/js/26.310db4f9.js"><link rel="prefetch" href="/continuous_learning/assets/js/27.8db0389d.js"><link rel="prefetch" href="/continuous_learning/assets/js/28.4ebae037.js"><link rel="prefetch" href="/continuous_learning/assets/js/29.b98a7475.js"><link rel="prefetch" href="/continuous_learning/assets/js/3.9d2c09c2.js"><link rel="prefetch" href="/continuous_learning/assets/js/30.054bb0af.js"><link rel="prefetch" href="/continuous_learning/assets/js/31.04abd7a6.js"><link rel="prefetch" href="/continuous_learning/assets/js/32.3af01b1a.js"><link rel="prefetch" href="/continuous_learning/assets/js/33.cc1c2b5e.js"><link rel="prefetch" href="/continuous_learning/assets/js/34.505c830d.js"><link rel="prefetch" href="/continuous_learning/assets/js/35.b13d6d1b.js"><link rel="prefetch" href="/continuous_learning/assets/js/36.5e26b1a9.js"><link rel="prefetch" href="/continuous_learning/assets/js/37.4d62416f.js"><link rel="prefetch" href="/continuous_learning/assets/js/38.798af47a.js"><link rel="prefetch" href="/continuous_learning/assets/js/39.e832d8f9.js"><link rel="prefetch" href="/continuous_learning/assets/js/4.80d1ecbf.js"><link rel="prefetch" href="/continuous_learning/assets/js/40.a116f5f6.js"><link rel="prefetch" href="/continuous_learning/assets/js/41.81f443ef.js"><link rel="prefetch" href="/continuous_learning/assets/js/42.dab33553.js"><link rel="prefetch" href="/continuous_learning/assets/js/43.f7aa12a1.js"><link rel="prefetch" href="/continuous_learning/assets/js/44.38ae6c2c.js"><link rel="prefetch" href="/continuous_learning/assets/js/45.18144b73.js"><link rel="prefetch" href="/continuous_learning/assets/js/46.a67e028e.js"><link rel="prefetch" href="/continuous_learning/assets/js/47.e7dff58c.js"><link rel="prefetch" href="/continuous_learning/assets/js/48.a28d7bbe.js"><link rel="prefetch" href="/continuous_learning/assets/js/49.e35e8fd8.js"><link rel="prefetch" href="/continuous_learning/assets/js/5.10d702a2.js"><link rel="prefetch" href="/continuous_learning/assets/js/50.be4ffec3.js"><link rel="prefetch" href="/continuous_learning/assets/js/51.401ca435.js"><link rel="prefetch" href="/continuous_learning/assets/js/52.991e3791.js"><link rel="prefetch" href="/continuous_learning/assets/js/53.6c378e84.js"><link rel="prefetch" href="/continuous_learning/assets/js/54.afd3b835.js"><link rel="prefetch" href="/continuous_learning/assets/js/55.e6e8b14a.js"><link rel="prefetch" href="/continuous_learning/assets/js/56.6999b1e2.js"><link rel="prefetch" href="/continuous_learning/assets/js/57.906f930f.js"><link rel="prefetch" href="/continuous_learning/assets/js/58.17474ef6.js"><link rel="prefetch" href="/continuous_learning/assets/js/59.c4205278.js"><link rel="prefetch" href="/continuous_learning/assets/js/6.4e1b404c.js"><link rel="prefetch" href="/continuous_learning/assets/js/60.365fc4b1.js"><link rel="prefetch" href="/continuous_learning/assets/js/61.9199b6ad.js"><link rel="prefetch" href="/continuous_learning/assets/js/62.c2e31630.js"><link rel="prefetch" href="/continuous_learning/assets/js/63.fde82eaf.js"><link rel="prefetch" href="/continuous_learning/assets/js/64.b3167bde.js"><link rel="prefetch" href="/continuous_learning/assets/js/65.840325b4.js"><link rel="prefetch" href="/continuous_learning/assets/js/66.06121a45.js"><link rel="prefetch" href="/continuous_learning/assets/js/67.9e4fea73.js"><link rel="prefetch" href="/continuous_learning/assets/js/68.a7170c34.js"><link rel="prefetch" href="/continuous_learning/assets/js/69.3c0af0df.js"><link rel="prefetch" href="/continuous_learning/assets/js/7.c4b094c5.js"><link rel="prefetch" href="/continuous_learning/assets/js/70.a3292e1c.js"><link rel="prefetch" href="/continuous_learning/assets/js/71.648ff042.js"><link rel="prefetch" href="/continuous_learning/assets/js/72.f509ed4f.js"><link rel="prefetch" href="/continuous_learning/assets/js/73.94b10fa6.js"><link rel="prefetch" href="/continuous_learning/assets/js/74.a34a5838.js"><link rel="prefetch" href="/continuous_learning/assets/js/75.29cd3ddd.js"><link rel="prefetch" href="/continuous_learning/assets/js/76.80dfd8aa.js"><link rel="prefetch" href="/continuous_learning/assets/js/77.61272f4f.js"><link rel="prefetch" href="/continuous_learning/assets/js/78.18964c2c.js"><link rel="prefetch" href="/continuous_learning/assets/js/79.a9e33c5e.js"><link rel="prefetch" href="/continuous_learning/assets/js/vendors~docsearch.bd0b093a.js">
    <link rel="stylesheet" href="/continuous_learning/assets/css/0.styles.6479703d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/continuous_learning/" class="home-link router-link-active"><img src="/continuous_learning/img/logo.png" alt="时空随笔" class="logo"> <span class="site-name can-hide">时空随笔</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/continuous_learning/index.html" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/HTMLAndCSS.html" class="nav-link">
  HTML和CSS
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/javascript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/typescript.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/node.js.html" class="nav-link">
  node.js
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/solid.html" class="nav-link">
  设计模式与数据结构
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/variable.html" class="nav-link">
  EnglishVariable
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/English.html" class="nav-link">
  EnglishArticle
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="轮子" class="dropdown-title"><span class="title">轮子</span> <span class="arrow down"></span></button> <button type="button" aria-label="轮子" class="mobile-dropdown-title"><span class="title">轮子</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vue.html" class="nav-link">
  vue语法
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vue_source.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue源码
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vue_ecology.html" class="nav-link">
  Vue生态
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/react.html" class="nav-link">
  react语法
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/React_source.html" class="nav-link">
  React源码
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vueInfrastructure.html" class="nav-link">
  vue基建
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/esbuild.html" class="nav-link">
  esbuild
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vite.html" class="nav-link">
  vite
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/rollup.html" class="nav-link">
  rollup
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/test_tool.html" class="nav-link">
  测试工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试" class="mobile-dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/EssenceSummary.html" class="nav-link">
  精华
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/technologyOne.html" class="nav-link">
  技术类1
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/chat.html" class="nav-link">
  闲谈
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/handwriting.html" class="nav-link">
  手写题
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/algorithm.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/algorithmOne.html" class="nav-link">
  算法题1
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/algorithmTwo.html" class="nav-link">
  算法题2
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/QA.html" class="nav-link">
  AI问答
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/other.html" class="nav-link">
  AI随便问问
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作经历" class="dropdown-title"><span class="title">工作经历</span> <span class="arrow down"></span></button> <button type="button" aria-label="工作经历" class="mobile-dropdown-title"><span class="title">工作经历</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/MigratingFromVue2ToVue3.html" class="nav-link">
  从Vue2迁移到Vue3
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/PromiseDialog.html" class="nav-link">
  基于Promise调用子组件弹窗
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/permission.html" class="nav-link">
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/PerformanceOptimization.html" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/I18n.html" class="nav-link">
  国际化
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/DynamicForm.html" class="nav-link">
  动态表单
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/cli.html" class="nav-link">
  脚手架
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/FileUpload.html" class="nav-link">
  大文件上传
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/LowCode.html" class="nav-link">
  低代码
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/EchartsHook.html" class="nav-link">
  Echarts图表
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/sortable.html" class="nav-link">
  可排序的
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/sdk.html" class="nav-link">
  sdk前端埋点
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/CICD.html" class="nav-link">
  持续集成持续部署
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/ConfigProvider.html" class="nav-link">
  配置式Provider
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/VirtualScrolling.html" class="nav-link">
  虚拟滚动
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/ThousandSeparatorAmoutInput.html" class="nav-link">
  千分符金额文本框组件
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/WebSocket.html" class="nav-link">
  WebSocket
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/seo.html" class="nav-link">
  SEO
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/largeScreen.html" class="nav-link">
  大屏
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/safe.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/singleSignOn.html" class="nav-link">
  单点登录
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/video_merger.html" class="nav-link">
  视频合成
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/music_soft.html" class="nav-link">
  音乐软件
</a></li></ul></div></div> <a href="https://github.com/forfreeagainst/continuous_learning" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/continuous_learning/index.html" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/HTMLAndCSS.html" class="nav-link">
  HTML和CSS
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/javascript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/typescript.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/node.js.html" class="nav-link">
  node.js
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/solid.html" class="nav-link">
  设计模式与数据结构
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/variable.html" class="nav-link">
  EnglishVariable
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/develop/English.html" class="nav-link">
  EnglishArticle
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="轮子" class="dropdown-title"><span class="title">轮子</span> <span class="arrow down"></span></button> <button type="button" aria-label="轮子" class="mobile-dropdown-title"><span class="title">轮子</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vue.html" class="nav-link">
  vue语法
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vue_source.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue源码
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vue_ecology.html" class="nav-link">
  Vue生态
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/react.html" class="nav-link">
  react语法
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/React_source.html" class="nav-link">
  React源码
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vueInfrastructure.html" class="nav-link">
  vue基建
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/esbuild.html" class="nav-link">
  esbuild
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/vite.html" class="nav-link">
  vite
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/rollup.html" class="nav-link">
  rollup
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/wheel/test_tool.html" class="nav-link">
  测试工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试" class="mobile-dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/EssenceSummary.html" class="nav-link">
  精华
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/technologyOne.html" class="nav-link">
  技术类1
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/chat.html" class="nav-link">
  闲谈
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/handwriting.html" class="nav-link">
  手写题
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/algorithm.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/algorithmOne.html" class="nav-link">
  算法题1
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/algorithmTwo.html" class="nav-link">
  算法题2
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/QA.html" class="nav-link">
  AI问答
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/interview/other.html" class="nav-link">
  AI随便问问
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作经历" class="dropdown-title"><span class="title">工作经历</span> <span class="arrow down"></span></button> <button type="button" aria-label="工作经历" class="mobile-dropdown-title"><span class="title">工作经历</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/MigratingFromVue2ToVue3.html" class="nav-link">
  从Vue2迁移到Vue3
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/PromiseDialog.html" class="nav-link">
  基于Promise调用子组件弹窗
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/permission.html" class="nav-link">
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/PerformanceOptimization.html" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/I18n.html" class="nav-link">
  国际化
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/DynamicForm.html" class="nav-link">
  动态表单
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/cli.html" class="nav-link">
  脚手架
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/FileUpload.html" class="nav-link">
  大文件上传
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/LowCode.html" class="nav-link">
  低代码
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/EchartsHook.html" class="nav-link">
  Echarts图表
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/sortable.html" class="nav-link">
  可排序的
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/sdk.html" class="nav-link">
  sdk前端埋点
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/CICD.html" class="nav-link">
  持续集成持续部署
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/ConfigProvider.html" class="nav-link">
  配置式Provider
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/VirtualScrolling.html" class="nav-link">
  虚拟滚动
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/ThousandSeparatorAmoutInput.html" class="nav-link">
  千分符金额文本框组件
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/WebSocket.html" class="nav-link">
  WebSocket
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/seo.html" class="nav-link">
  SEO
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/largeScreen.html" class="nav-link">
  大屏
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/safe.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/singleSignOn.html" class="nav-link">
  单点登录
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/video_merger.html" class="nav-link">
  视频合成
</a></li><li class="dropdown-item"><!----> <a href="/continuous_learning/job_experience/music_soft.html" class="nav-link">
  音乐软件
</a></li></ul></div></div> <a href="https://github.com/forfreeagainst/continuous_learning" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>轮子</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/continuous_learning/wheel/vue.html" class="sidebar-link">vue语法</a></li><li><a href="/continuous_learning/wheel/vue_source.html" aria-current="page" class="active sidebar-link">vue源码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/continuous_learning/wheel/vue_source.html#vue3源码" class="sidebar-link">Vue3源码</a></li><li class="sidebar-sub-header"><a href="/continuous_learning/wheel/vue_source.html#vue讲述" class="sidebar-link">Vue讲述</a></li><li class="sidebar-sub-header"><a href="/continuous_learning/wheel/vue_source.html#面试题" class="sidebar-link">面试题</a></li><li class="sidebar-sub-header"><a href="/continuous_learning/wheel/vue_source.html#vue2源码" class="sidebar-link">Vue2源码</a></li></ul></li><li><a href="/continuous_learning/wheel/vue_ecology.html" class="sidebar-link">Vue生态</a></li><li><a href="/continuous_learning/wheel/react.html" class="sidebar-link">react语法</a></li><li><a href="/continuous_learning/wheel/React_source.html" class="sidebar-link">React源码</a></li><li><a href="/continuous_learning/wheel/vueInfrastructure.html" class="sidebar-link">vue基建</a></li><li><a href="/continuous_learning/wheel/esbuild.html" class="sidebar-link">esbuild</a></li><li><a href="/continuous_learning/wheel/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/continuous_learning/wheel/vite.html" class="sidebar-link">vite</a></li><li><a href="/continuous_learning/wheel/rollup.html" class="sidebar-link">rollup</a></li><li><a href="/continuous_learning/wheel/test_tool.html" class="sidebar-link">测试工具</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工作经历</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue源码"><a href="#vue源码" class="header-anchor">#</a> Vue源码</h1> <h2 id="vue3源码"><a href="#vue3源码" class="header-anchor">#</a> Vue3源码</h2> <h3 id="set、map、weakset、weakmap区别"><a href="#set、map、weakset、weakmap区别" class="header-anchor">#</a> Set、Map、WeakSet、WeakMap区别？</h3> <h4 id="set-集合"><a href="#set-集合" class="header-anchor">#</a> Set（集合）</h4> <ul><li>存储结构：[值, 值]，存储唯一的值（不允许重复）。</li> <li>键类型：任意类型的值（包括对象、原始值）。</li> <li>可遍历：是（支持 forEach、keys()、values()、entries() 等方法）。</li> <li>引用类型：强引用（即使对象不再使用，也不会被垃圾回收）。</li></ul> <p>常用方法：</p> <ul><li>add(value)：添加值。</li> <li>delete(value)：删除值。</li> <li>has(value)：检查是否存在某值。</li> <li>clear()：清空集合。</li></ul> <p>使用场景：数组去重、集合运算（并集、交集等）。</p> <h4 id="weakset-弱集合"><a href="#weakset-弱集合" class="header-anchor">#</a> WeakSet（弱集合）</h4> <ul><li>存储结构：[值, 值]，但仅能存储对象（不能是原始值）。</li> <li>键类型：仅对象（如 {}、new Object()）。</li> <li>可遍历：否（没有 size 属性，也不能用 forEach 或迭代方法）。</li> <li>引用类型：弱引用（如果对象在其他地方没有被引用，会被垃圾回收自动清除）。</li></ul> <p>常用方法：</p> <ul><li>add(obj)：添加对象。</li> <li>delete(obj)：删除对象。</li> <li>has(obj)：检查是否存在某对象。</li></ul> <p>使用场景：临时存储对象（如 DOM 节点是否已被处理）。</p> <h4 id="map-字典"><a href="#map-字典" class="header-anchor">#</a> Map（字典）</h4> <ul><li>存储结构：[键, 值]，键值对集合。</li> <li>键类型：任意类型（对象、原始值均可）。</li> <li>可遍历：是（支持 forEach、keys()、values()、entries() 等方法）。</li> <li>引用类型：强引用（键和值都不会被垃圾回收）。</li></ul> <p>常用方法：</p> <ul><li>set(key, value)：设置键值对。</li> <li>get(key)：获取值。</li> <li>delete(key)：删除键值对。</li> <li>has(key)：检查是否存在某键。</li> <li>clear()：清空字典。</li></ul> <p>使用场景：需要复杂键（如对象）的映射、缓存、数据关联。</p> <h4 id="weakmap-弱字典"><a href="#weakmap-弱字典" class="header-anchor">#</a> WeakMap（弱字典）</h4> <ul><li>存储结构：[键, 值]，但键必须是对象（值可以是任意类型）。</li> <li>键类型：仅对象（不能是原始值）。</li> <li>可遍历：否（没有 size 属性，也不能用 forEach 或迭代方法）。</li> <li>引用类型：弱引用（仅对键弱引用，如果键对象在其他地方没有被引用，会被垃圾回收，对应的值也会被释放）。</li></ul> <p>常用方法：</p> <ul><li>set(key, value)：设置键值对（key 必须是对象）。</li> <li>get(key)：获取值。</li> <li>delete(key)：删除键值对。</li> <li>has(key)：检查是否存在某键。</li></ul> <p>使用场景：存储对象的私有数据或元数据（避免内存泄漏）。</p> <p>帮助内存管理的数据结构：WeakMap,WeakSet。尽管JavaScript没有直接暴露垃圾回收器API。但语言
提供几个间接观察垃圾回收的数据结构，能用于内存管理。</p> <table><thead><tr><th>特性</th> <th>Set</th> <th>WeakSet</th> <th>Map</th> <th>WeakMap</th></tr></thead> <tbody><tr><td>存储结构</td> <td>[值，值]</td> <td>[对象，对象]</td> <td>[键，值]</td> <td>[对象键，值]</td></tr> <tr><td>键类型</td> <td>任意值</td> <td>仅对象</td> <td>任意值</td> <td>仅对象</td></tr> <tr><td>可遍历性</td> <td>可</td> <td>不可</td> <td>可</td> <td>不可</td></tr> <tr><td>引用类型</td> <td>强引用</td> <td>弱引用</td> <td>强引用</td> <td>弱引用（仅键）</td></tr> <tr><td>垃圾回收影响</td> <td>不回收</td> <td>自动回收</td> <td>不回收</td> <td>自动回收</td></tr> <tr><td>典型用途</td> <td>去重、集合运算</td> <td>临时对象管理</td> <td>复杂键映射</td> <td>对象私有数据</td></tr></tbody></table> <h4 id="关键性总结"><a href="#关键性总结" class="header-anchor">#</a> 关键性总结</h4> <ul><li>Set vs WeakSet</li></ul> <p>Set 可以存储任意值，WeakSet 只能存储对象。</p> <p>Set 可遍历，WeakSet 不可遍历。</p> <p>WeakSet 对对象是弱引用，适合临时存储（如 DOM 节点管理）。</p> <ul><li>Map vs WeakMap</li></ul> <p>Map 的键可以是任意类型，WeakMap 的键必须是对象。</p> <p>Map 可遍历，WeakMap 不可遍历。</p> <p>WeakMap 对键是弱引用，适合存储对象的私有数据（避免内存泄漏）。</p> <ul><li>强引用 vs 弱引用</li></ul> <p>Set 和 Map 会阻止垃圾回收，可能导致内存泄漏。</p> <p>WeakSet 和 WeakMap 不会阻止垃圾回收，适合临时存储。</p> <h2 id="vue讲述"><a href="#vue讲述" class="header-anchor">#</a> Vue讲述</h2> <h3 id="响应式模块"><a href="#响应式模块" class="header-anchor">#</a> 响应式模块</h3> <div class="language-md extra-class"><pre class="language-md"><code>effect是个副作用，数据发生改变，立即执行effect。我们通过数据代理，在get和set方法进行切面编程，
get里面进行依赖收集，把effect中 使用到的变量 和 effect 进行关联，形成一个映射表。
get里面进行触发更新，数据发生改变，调用映射表的effect方法，进行页面数据的渲染(innerHTML)。

effect: 数据发生改变立即执行effect
watch, computed 都是基于 effect ，
effect(() =&gt; {
    document.innerHTML = <span class="token code-snippet code keyword">`hello${name}`</span>;
}, {}); // 执行函数，选项
写在effect里面的变量，才具有响应式。
父子组件，就是嵌套的effect;

设计响应式的effect
effect访问 对象的属性进行 依赖收集， 书写innerHTML = 啥 进行触发更新。
trackEffect, triggerEffect
<span class="token list punctuation">1.</span> 在proxy 的get 进行 依赖收集，

收集这个对象上的这个属性和 effect关联在一起。
收集依赖的数据格式 
 Map:  obj:  {属性 ： Map:  effect, effect, effect   }
嵌套Map ,
第一层： 对象，  Map
第二层： 属性， Map 


// 将当前的effect放入到dep （映射表）中，后续可以根据值得变化触发此dep中存放的 effect 。

<span class="token list punctuation">2.</span> 触发更新


<span class="token list punctuation">3.</span> 解决effect 的遗留问题
effect 有条件（前后的依赖不一样的各种情况） state.flag ? state.name : state.age;
（effect在进行第二次依赖收集，有个简单的diff算法））
effect 有重复的，映射表要去重  state.name + state.name

<span class="token list punctuation">4.</span> effect调度实现 （effect第二个参数scheduler, 数据更新了，不重新渲染，走自己的逻辑。
还可以赋值给变量即函数名，然后在scheduler中调用）。

<span class="token list punctuation">5.</span> 解决 innerHTML = state.name; state.name = 22; 陷入死循环
  当取的值也是对象的时候，我需要对这个对象 再进行代理，递归代理


reactive只能针对对象， proxy就是针对对象呀

ref 实现原理， 可以是基础类型，可以是对象
包了一层，成为对象。拥有三个属性：_v,  get方法 ，set方法
contructor：判断是不是对象 ,是的话，包一层reactive

其他API: toRef, toRefs, proxyRef, proxyRefs

书写computed, 也是ref (ref特征 _v, get value方法， set value方法)

思路：

</code></pre></div><p>缩略版 computed</p> <div class="language-ts extra-class"><pre class="language-ts"><code> <span class="token comment">// 在effect 里用到 fullname.value才行</span>
<span class="token comment">// const fullname = computed(() =&gt; state.firstname + state.name);</span>
<span class="token comment">// effect(() =&gt; {</span>
<span class="token comment">//   console.log(fullname.value);</span>
<span class="token comment">// })</span>


<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ComputedRefImpl<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _value<span class="token operator">!</span><span class="token operator">:</span> <span class="token constant">T</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    getter<span class="token operator">:</span> ComputedGetter<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> _setter<span class="token operator">:</span> ComputedSetter<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>effect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReactiveEffect</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">getter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">triggerRefValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> DirtyLevels<span class="token punctuation">.</span>ComputedValueMaybeDirty<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">trackRefValue</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>

    <span class="token keyword">return</span> self<span class="token punctuation">.</span>_value
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">value</span><span class="token punctuation">(</span>newValue<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_setter</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// #region polyfill _dirty for backward compatibility third party code for Vue &lt;= 3.3.x</span>
  <span class="token keyword">get</span> <span class="token function">_dirty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>effect<span class="token punctuation">.</span>dirty
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">_dirty</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>effect<span class="token punctuation">.</span>dirty <span class="token operator">=</span> v
  <span class="token punctuation">}</span>
  <span class="token comment">// #endregion</span>
<span class="token punctuation">}</span>
</code></pre></div><p>reactiveEffect: 接收参数: getter函数，调度器
收集依赖，</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ReactiveEffect<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  active <span class="token operator">=</span> <span class="token boolean">true</span>
  deps<span class="token operator">:</span> Dep<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token comment">/**
   * Can be attached after creation
   * @internal
   */</span>
  computed<span class="token operator">?</span><span class="token operator">:</span> ComputedRefImpl<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
  <span class="token comment">/**
   * @internal
   */</span>
  allowRecurse<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>

  onStop<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  <span class="token comment">// dev only</span>
  onTrack<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> DebuggerEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  <span class="token comment">// dev only</span>
  onTrigger<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> DebuggerEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>

  <span class="token comment">/**
   * @internal
   */</span>
  _dirtyLevel <span class="token operator">=</span> DirtyLevels<span class="token punctuation">.</span>Dirty
  <span class="token comment">/**
   * @internal
   */</span>
  _trackId <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token comment">/**
   * @internal
   */</span>
  _runnings <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token comment">/**
   * @internal
   */</span>
  _queryings <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token comment">/**
   * @internal
   */</span>
  _depsLength <span class="token operator">=</span> <span class="token number">0</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword">public</span> <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">,</span>
    <span class="token keyword">public</span> <span class="token function-variable function">trigger</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
    <span class="token keyword">public</span> scheduler<span class="token operator">?</span><span class="token operator">:</span> EffectScheduler<span class="token punctuation">,</span>
    scope<span class="token operator">?</span><span class="token operator">:</span> EffectScope<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">recordEffectScope</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> scope<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">get</span> <span class="token function">dirty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_dirtyLevel <span class="token operator">===</span> DirtyLevels<span class="token punctuation">.</span>ComputedValueMaybeDirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_dirtyLevel <span class="token operator">=</span> DirtyLevels<span class="token punctuation">.</span>NotDirty
      <span class="token keyword">this</span><span class="token punctuation">.</span>_queryings<span class="token operator">++</span>
      <span class="token function">pauseTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> dep <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>deps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dep<span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">triggerComputed</span><span class="token punctuation">(</span>dep<span class="token punctuation">.</span>computed<span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_dirtyLevel <span class="token operator">&gt;=</span> DirtyLevels<span class="token punctuation">.</span>ComputedValueDirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">resetTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_queryings<span class="token operator">--</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_dirtyLevel <span class="token operator">&gt;=</span> DirtyLevels<span class="token punctuation">.</span>ComputedValueDirty
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">set</span> <span class="token function">dirty</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_dirtyLevel <span class="token operator">=</span> v <span class="token operator">?</span> DirtyLevels<span class="token punctuation">.</span>Dirty <span class="token operator">:</span> DirtyLevels<span class="token punctuation">.</span>NotDirty
  <span class="token punctuation">}</span>

  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_dirtyLevel <span class="token operator">=</span> DirtyLevels<span class="token punctuation">.</span>NotDirty
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> lastShouldTrack <span class="token operator">=</span> shouldTrack
    <span class="token keyword">let</span> lastEffect <span class="token operator">=</span> activeEffect
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      shouldTrack <span class="token operator">=</span> <span class="token boolean">true</span>
      activeEffect <span class="token operator">=</span> <span class="token keyword">this</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_runnings<span class="token operator">++</span>
      <span class="token function">preCleanupEffect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token function">postCleanupEffect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_runnings<span class="token operator">--</span>
      activeEffect <span class="token operator">=</span> lastEffect
      shouldTrack <span class="token operator">=</span> lastShouldTrack
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">preCleanupEffect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
      <span class="token function">postCleanupEffect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>onStop<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>active <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>effect:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">effect</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> ReactiveEffectOptions<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ReactiveEffectRunner <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fn <span class="token keyword">as</span> ReactiveEffectRunner<span class="token punctuation">)</span><span class="token punctuation">.</span>effect <span class="token keyword">instanceof</span> <span class="token class-name">ReactiveEffect</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fn <span class="token operator">=</span> <span class="token punctuation">(</span>fn <span class="token keyword">as</span> ReactiveEffectRunner<span class="token punctuation">)</span><span class="token punctuation">.</span>effect<span class="token punctuation">.</span>fn
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> _effect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReactiveEffect</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token constant">NOOP</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_effect<span class="token punctuation">.</span>dirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _effect<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">extend</span><span class="token punctuation">(</span>_effect<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>scope<span class="token punctuation">)</span> <span class="token function">recordEffectScope</span><span class="token punctuation">(</span>_effect<span class="token punctuation">,</span> options<span class="token punctuation">.</span>scope<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>options <span class="token operator">||</span> <span class="token operator">!</span>options<span class="token punctuation">.</span>lazy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _effect<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> runner <span class="token operator">=</span> _effect<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>_effect<span class="token punctuation">)</span> <span class="token keyword">as</span> ReactiveEffectRunner
  runner<span class="token punctuation">.</span>effect <span class="token operator">=</span> _effect
  <span class="token keyword">return</span> runner
<span class="token punctuation">}</span>
</code></pre></div><p>特性	ReactiveEffect 类	effect 函数
层级	底层实现类	高级 API（基于 ReactiveEffect）
使用方式	需实例化并手动调用 run()	直接传入函数，自动执行和追踪
调度控制	支持自定义调度器（scheduler）	通过 effect 的选项间接支持
停止监听	调用 stop() 方法	返回 stop 函数
典型用途	Vue 内部实现（如渲染、computed、watch）	开发者显式管理副作用</p> <h3 id="runtime-dom"><a href="#runtime-dom" class="header-anchor">#</a> runtime-dom</h3> <p>提供 DOM API (提供一系列dom操作的api方法) ，针对浏览器的</p> <ol><li>createRenderer(RuntimeCore的方法) 我们可以自己创建渲染器 （自定义渲染器），接收rendererOptions</li> <li>render(RuntimeCore的方法) 用内置的渲染器来进行渲染 （渲染dom元素）(把虚拟节点变成真实节点)</li> <li>h方法可以创建一个虚拟dom (接收参数：type, propsOrChildren, children)</li></ol> <p>type 标签：div , propsOrChildren 属性 {}</p> <p>nodeOps 节点渲染
patchProp 属性渲染： attrs,class,events,props,style
events: 希望是一个() =&gt; 函数名， 这样可以移除事件和监听事件。</p> <p>引用关系：runtime-core -&gt; runtime-core -&gt; reactivity</p> <h3 id="runtime-core"><a href="#runtime-core" class="header-anchor">#</a> runtime-core</h3> <h4 id="重点看createrenderer-渲染器"><a href="#重点看createrenderer-渲染器" class="header-anchor">#</a> 重点看createRenderer (渲染器)</h4> <p>createRenderer 返回一个对象，有render方法，render方法中 会调用核心函数patch, patch会根据初次渲染和
更新渲染，把虚拟节点，转化为真实节点。</p> <p>createRenderer： 可以不针对浏览器的自定义渲染器，实现跨平台。
createRenderer：接收rendererOptions渲染器选项，自己有个render方法，</p> <p>render: 接收参数： vnode/虚拟dom, Element/dom节点</p> <p>Vue 3 的 Diff 比 Vue 2 更高效，主要依赖以下优化：</p> <p>优化策略	作用
静态提升（Hoist Static）	将静态节点（无动态绑定）提取到渲染函数外，复用旧 VNode，避免重复对比。
Patch Flags	在 VNode 上标记动态属性（如 class、style），仅对比变化的属性。
Block Tree	将模板划分为动态区块（Block），仅对比区块内的动态节点，跳过静态内容。
靶向更新	直接定位到动态节点，减少递归遍历。
1 &lt;&lt; 2 , 二进制数，左移两位。 1  2  4  8 16
组合起来，1111111， 一下子就看出来，它拥有全部的组合。10001，头和尾的组合。
| 或运算 1 | 8 得到9， &amp; 与运算</p> <p>Vue 3 的 Diff 比 Vue 2 更高效，主要依赖以下优化：</p> <p>优化策略	作用
静态提升（Hoist Static）	将静态节点（无动态绑定）提取到渲染函数外，复用旧 VNode，避免重复对比。
Patch Flags	在 VNode 上标记动态属性（如 class、style），仅对比变化的属性。
Block Tree	将模板划分为动态区块（Block），仅对比区块内的动态节点，跳过静态内容。
靶向更新	直接定位到动态节点，减少递归遍历。</p> <p>特性	render 函数	h 函数
角色	组件的视图生成器（返回整个 VNode 树）	单个 VNode 的工厂函数
调用者	Vue 内部调用（或开发者手动定义）	在 render 函数内部调用
输入	组件实例的 this（访问状态）	标签名/组件、props、children
输出	完整的 VNode 树	单个 VNode
是否必需	必须有（直接或间接）	可选（可用 JSX 替代）</p> <h4 id="组件"><a href="#组件" class="header-anchor">#</a> 组件</h4> <p>template 会变成 render函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> VueComponent <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'durant'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>Fragment<span class="token punctuation">,</span> <span class="token punctuation">[</span>
      <span class="token function">h</span><span class="token punctuation">(</span>Text<span class="token punctuation">,</span> <span class="token string">&quot;my name is&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// h 接收参数（type, propsOrChildren, children）</span>
<span class="token comment">// type： 是 文本，注释，Fragment, 元素（组件，div...）</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token function">h</span><span class="token punctuation">(</span>VueComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> app<span class="token punctuation">)</span>
</code></pre></div><p>组件渲染整理流程</p> <p>创建组件实例
给实例的属性赋值
创建一个effect</p> <h3 id="模板变成js语法"><a href="#模板变成js语法" class="header-anchor">#</a> 模板变成js语法</h3> <p>diff算法优化：</p> <p>如果在编写vue3的时候，你直接采用jsx 或者 h 的写法，得不到优化</p> <p>template 编译成 js 语法时，会有 PatchFlags，标记是文本、class, style等，没有
使用h, 使用了_createElementVNode。
反正用h是见得比较多，回头有用到_openBlock,_createElementBlock和_createElementVNode，再看一下吧。</p> <ul><li>PatchFlags 优化：只考虑属性和内容发生变化</li> <li>BlockTree: 处理 虚拟DOM 树的层级，v-if,v-else, v-for不确定有多少个</li></ul> <p>我觉得直接 编写 h 代码 ，实现 一些插件（eg: vue-draggable-plus等）功能很难的。
1.它可以通过书写template, 然后通过某些插件进行转换为 h语法。
2.或者通过vue转换语法的网站，实现代码编写。</p> <p>template 转换成 js 语法
1.“语法” 转化成一个对象 ast语法树
2.对树进行优化 （打标记 patchFlag）
3.根据转换后的代码生成 一个字符串。</p> <p>compile(模板) 得到 {
ast: {},
code: render函数的字符串
}</p> <p>编译主要分为三步</p> <ol><li>将模板转换成 ast语法树</li> <li>转换生成 codegennode</li> <li>转换成 render函数</li></ol> <p>状态机：循环每个字符，判断它是什么类型，然后分别进行处理</p> <h2 id="面试题"><a href="#面试题" class="header-anchor">#</a> 面试题</h2> <h3 id="请说以下-vue2-响应式数据的理解"><a href="#请说以下-vue2-响应式数据的理解" class="header-anchor">#</a> 请说以下 Vue2 响应式数据的理解</h3> <p>源码层面: 内部对所有属性进行了重写，性能问题，如果对象是多层级的，就会递归对象中的属性，增加
getter和 setter</p> <p>我们在使用Vue的时候，如果层级过深（考虑优化），如果数据不是响应式的，就不要放在data中了。
我们属性取值的时候尽量避免多次取值。如果有些对象放在 data中，但不是响应式的，可以考虑采用
Object.freeze() 来冻结对象。</p> <p>多次取值（多次访问get方法）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// 多次访问get方法</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  sum <span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">=</span> sum<span class="token punctuation">;</span>
</code></pre></div><h3 id="vue2中如何监测数组的变化"><a href="#vue2中如何监测数组的变化" class="header-anchor">#</a> Vue2中如何监测数组的变化？</h3> <p>vue2 中监测数组的变化 没有采用defineProperty, 因为修改索引的情况不多，如果直接使用defineProperty 会浪费大量性能。
采用重写数组的变异方法来实现函数劫持。</p> <p>initData -&gt; observe -&gt; 对我们传入的数组进行原型链修改，后续调用的方法都是 重写后的方法。-&gt;
对数组中每个对象 也再次进行代理</p> <p>修改数组索引，修改长度是无法进行监控的。arr[1] = 100; arr.length = 300;</p> <h3 id="vue中如何进行依赖收集"><a href="#vue中如何进行依赖收集" class="header-anchor">#</a> Vue中如何进行依赖收集？</h3> <p>所谓的依赖收集（观察者模式），被观察者指代的是数据(dep), 观察者（watcher）
一个watcher中 可能对应着 多个数据，watcher 中还需要 保存dep, (重新渲染的时候可以让属性重新记录watcher)</p> <p>多对多的关系 一个dep 对应多个watcher, 一个watcher 有多个dep。默认渲染的时候会进行依赖收集（会触发get方法），
数据更新了就找到属性对应的watcher去触发更新。</p> <h3 id="如何理解vue中模板编译原理"><a href="#如何理解vue中模板编译原理" class="header-anchor">#</a> 如何理解Vue中模板编译原理？</h3> <p>我们用户传递的是template 属性，我们需要将这个template 编译成 render函数</p> <p>template ——&gt; ast语法树
对语法树进行标记 （标记的是静态节点）
将ast 语法树生成 render函数</p> <p>最终每次渲染可以调用render函数返回对应的虚拟节点（递归是先子后父）</p> <h3 id="vue生命周期钩子是如何实现的"><a href="#vue生命周期钩子是如何实现的" class="header-anchor">#</a> Vue生命周期钩子是如何实现的</h3> <p>内部利用了一个发布订阅模式，将用户写的钩子维护成了一个数组，后续一次调用callback.</p> <h2 id="vue2源码"><a href="#vue2源码" class="header-anchor">#</a> Vue2源码</h2> <p><code>自己理解，并不一定对</code></p> <p>new Vue() 做了啥？
1.调用_init方法
2. 合并选项</p> <p>Observer类，Dep类，
渲染完真实DOM,
再开启监听者模式，Object.defineProperty.
get: dep.depend(); set: dep.notify();</p> <h3 id="api的实现"><a href="#api的实现" class="header-anchor">#</a> API的实现</h3> <h4 id="ref的实现"><a href="#ref的实现" class="header-anchor">#</a> ref的实现</h4> <p>包了一层对象，{_v, get, set} 里面的_v如果是 引用类型，也是个proxy</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/continuous_learning/wheel/vue.html" class="prev">
        vue语法
      </a></span> <span class="next"><a href="/continuous_learning/wheel/vue_ecology.html">
        Vue生态
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/continuous_learning/assets/js/app.a36e4480.js" defer></script><script src="/continuous_learning/assets/js/2.37a86b2d.js" defer></script><script src="/continuous_learning/assets/js/1.f80ffb5b.js" defer></script><script src="/continuous_learning/assets/js/80.e8ad302b.js" defer></script>
  </body>
</html>
